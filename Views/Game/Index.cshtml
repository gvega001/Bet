@model IEnumerable<Bet.DTO.GameDto>

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Game</h2>

<p>
    @Html.ActionLink("Create Game","New", "Game", null, new{@class="btn btn-primary"})
</p>

<table id="games" class="table">
    <tr>
        <th>Event Name</th>
        <th> Delete</th>
    </tr>
    <tbody></tbody>


</table>

@section scripts
{<script>
     $(document).ready(function () {
         $("#games").DataTable({
             ajax: {
                 url: "/api/games",
                 dataSrc: ""
             },
             columns: [
                 {
                     data: "name",
                     render: function(data, type, game) {
                         return "<a href=' /game/details/" + game.id + "'>" + game.name + "</a>";

                     }
                 },
               
                 {
                     data: "id",
                     render: function(data) {
                         return "<button class= 'btn-link js-delete' data-game-id=" + data + ">Delete</button>";
                     }
                 }
             ]
         });

         $("#games").on("click"," .js-delete",
             function () {
                 var button = $(this);

                 bootbox.confirm("Are you sure you want to delete this game", function(result) {
                     if (result) {
                         $.ajax({
                             url: "/api/games/" + $(this).attr("data-game-id"),
                             method: "DELETE",
                             success: function () {
                                 button.parents("tr").remove();
                             }
                         });
                     }
                 });
                   
             });
     });
 </script>
}
